---
title: "06_analysis_02.qmd"
format: html
editor: visual
author: "Anna Boateng: s175562, Marlies Goedknegt: s220675, Anne Gjelstrup: s194530, Katja Jagd: s185395, Olivia Ronnenberg: s183359"
---

## Part 06: analysis 2

### Install the required packages

```{r}
#| label: load packages
library("tidyverse")
```

### Plot of target molecules before and after

```{r}
coexpression_aug <- read_tsv("../data/03_coexpression_aug.tsv.gz",
                               show_col_types = FALSE)
```

```{r}
target_aug |> 
  ggplot(aes(x = upstream_regulator,
               y = change_in_n_molecules,
             fill = case_when(change_in_n_molecules >= 0 ~ "positive",
                              change_in_n_molecules < 0 ~  "negative")))+
  geom_col()+ 
   theme_minimal(base_size = 10) +
  theme(legend.position = "bottom",
        axis.text.x = element_text(angle = 55,
                                   hjust = 1,
                                   vjust = 1.5))+
  scale_fill_manual(values = c("positive" = "green", "negative" = "red"))+
  labs(x = "Upstream regulator",
       y = "Change in target molecules")
  
```

### Header for Anne

```{r}

coexpression_clean <- read_tsv("../data/01_coexpression_load.tsv.gz",
                               show_col_types = FALSE)

coexpression_clean <- coexpression_clean |>
  pivot_longer(cols = everything(),
               names_to = "modules",
               values_to = "gene")


tester <- target_data |>
  slice(1) |>
  select(contains("before")) |>
  select(2:last_col()) |>
  map_df( ~ coexpression_clean |> filter(gene == .x) |> select(c("modules",gene)))

```

### Header for Katja

```{r}

coexpression_clean <- read_tsv("../data/01_coexpression_load.tsv.gz",
                               show_col_types = FALSE)

coexpression_clean <- coexpression_clean |>
  pivot_longer(cols = everything(),
               names_to = "modules",
               values_to = "gene")


tester <- target_data |>
  slice(1) |>
  select(contains("before")) |>
  select(2:last_col()) |>
  map_df( ~ coexpression_clean |> filter(gene == .x) |> select(c("modules",gene)))

```

