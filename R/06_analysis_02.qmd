---
title: "06_analysis_02.qmd"
format: html
editor: visual
author: "Anna Boateng: s175562, Marlies Goedknegt: s220675, Anne Gjelstrup: s194530, Katja Jagd: s185395, Olivia Ronnenberg: s183359"
---

## Part 06: analysis 2

### Install the required packages

```{r}
#| label: load packages
library("tidyverse")
```

### Plot of target molecules before and after

```{r}
coexpression_aug <- read_tsv("../data/03_coexpression_aug.tsv.gz",
                               show_col_types = FALSE)
```

```{r}
target_aug |> 
  ggplot(aes(x = upstream_regulator,
               y = change_in_n_molecules,
             fill = case_when(change_in_n_molecules >= 0 ~ "positive",
                              change_in_n_molecules < 0 ~  "negative")))+
  geom_col(color  = "black")+ 
   theme_minimal(base_size = 10) +
  theme(legend.position = "bottom",
        axis.text.x = element_text(angle = 55,
                                   hjust = 1,
                                   vjust = 1.1))+
  scale_fill_manual(values = c("positive" = "#117733",
                               "negative" = "#661100"))+
  labs(x = "Upstream regulator",
       y = "Change in target molecules",
       title = "Target molecules before and after tDMARD treatment")
  
```

### Header for Anne

```{r}


target_data |>
  filter(upstream_regulator == "TREM1") |>
  select(contains("molecule_before")) |>
  map_df( ~ coexpression_clean |> 
            filter(gene == .x) |> 
            select(c("modules",
                     gene))) |>
  count(modules, name = "TREM1")



```


