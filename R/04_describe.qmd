---
title: "03_describe.qmd"
format: html
editor: visual
author: "Anna Boateng: s175562, Marlies Goedknegt: s220675, Anne Gjelstrup: s194530, Katja Jagd: s185395, Olivia Ronnenberg: s183359"
---

# Part 04: describe

## Import the required packages

```{r}
#| label: load packages
#| message: false

library("tidyverse")
library("ggthemes")

```

## Description of the data tables

After cleaning and augmenting the data, 3 main dataframes will be present:

-   A table containing coexpression modules and the genes for the regulator molecules that play a role in each of these modules called "03_coexpression_aug"
-   A table containing the regulator molecules and their related target molecules, both before and after treatment called "03_expr_target_aug"
-   A table containing the regulator molecules and their respective expression levels, both before and after called "03_expr_intersect_aug"

Furthermore, the dataframe

These tables can be found as .tsv.gz files, generated by the previous code.

## Dimensions of the data

The data tables each consists of:

- Table "coexpression_aug": 111700 observations and 2 variables. 
- Table "expr_before_aug": 849 observations and 5 variables. 
- Table "expr_after_aug": 595 observations and 5 variables.
- Table "expr_intersect_aug": 397 observations and 8 variables.
- Table "target_intersect_aug": 397 observations and 416 variables. 

This can be analyzed with the code below.

### Dimensions of table coexpression_aug

```{r}
#| label: data dimensions
#| echo: false


table1_dimensions <- dim(coexpression_aug)
table1_variables <- ncol(coexpression_aug)
table1_observations <- nrow(coexpression_aug)

table1_dimensions
table1_variables
table1_observations

```

### Dimensions of table expr_before_aug

```{r}

#| label: data dimensions
#| echo: false


table2_dimensions <- dim(expr_before_aug)
table2_variables <- ncol(expr_before_aug)
table2_observations <- nrow(expr_before_aug)

table2_dimensions
table2_variables
table2_observations
```

### Dimensions of table expr_after_aug

```{r}

#| label: data dimensions
#| echo: false


table3_dimensions <- dim(expr_after_aug)
table3_variables <- ncol(expr_after_aug)
table3_observations <- nrow(expr_after_aug)

table3_dimensions
table3_variables
table3_observations
```

### Dimensions of table expr_intersect_aug

```{r}

#| label: data dimensions
#| echo: false


table4_dimensions <- dim(expr_intersect_aug)
table4_variables <- ncol(expr_intersect_aug)
table4_observations <- nrow(expr_intersect_aug)

table4_dimensions
table4_variables
table4_observations
```

### Dimensions of table target_intersect_aug

```{r}

#| label: data dimensions
#| echo: false


table5_dimensions <- dim(target_intersect_aug)
table5_variables <- ncol(target_intersect_aug)
table5_observations <- nrow(target_intersect_aug)

table5_dimensions
table5_variables
table5_observations
```



## Barplots

### Barplot of target molecules before treatment

```{r}
ggplot(
  # Setting data
  data = target_intersect_aug,
  # Sorting it after highest frequency
  aes(x = upstream_regulator, y = n_before)
  )+ 
  # Making a barplot
  geom_col()+
  # Setting titles
  labs(
    title = "Target molecules before treatment",
    subtitle = "The number of times a target molecule is present in the dataset before treatment",
    x = "Target molecule",
    y = "Count"
  )+
  # colorblind friendly colors
  scale_color_colorblind()

```

### Barplot for target molecules after treatment

```{r}
ggplot(
  # Setting data
  data = target_intersect_aug,
  # Sorting it after highest frequency
  aes(x = upstream_regulator, y = n_after)
  )+ 
  # Making a barplot
  geom_col()+
  # Setting titles
  labs(
    title = "Target molecules before treatment",
    subtitle = "The number of times a target molecule is present in the dataset before treatment",
    x = "Target molecule",
    y = "Count"
  )+
  # colorblind friendly colors
  scale_color_colorblind()
```
